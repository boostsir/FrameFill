我來幫你撰寫一個詳細的產品規格文件，讓 AI 能夠清楚理解並實作這個圖片背景添加工具。

# 圖片背景添加工具 - 產品規格文件 (PRODUCT_SPEC)

## 1. 產品概述

### 1.1 產品名稱

Image Background Composer (圖片背景編輯器)

### 1.2 產品目標

創建一個純前端的單頁應用程式，允許用戶上傳圖片並為其添加自定義背景，生成新尺寸的圖片，整個過程完全在瀏覽器端完成，無需後端服務。

### 1.3 核心價值

- **零依賴後端**：所有處理都在客戶端完成
- **即時預覽**：用戶可以實時看到調整效果
- **簡單直觀**：單一功能，操作流程清晰
- **隱私保護**：圖片不會上傳到任何服務器

## 2. 技術架構

### 2.1 技術棧

- **HTML5**: 結構層
- **UIKit 3.x**: CSS 框架
- **JavaScript ES6+**: 純原生 JavaScript，不使用 TypeScript
- **Canvas API**: 圖片處理核心
- **File API**: 本地文件處理
- **Color Thief** (可選): 圖片顏色提取（使用 CDN 載入）

### 2.2 瀏覽器支持

- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

## 3. 功能規格

### 3.1 圖片上傳模組

#### 3.1.1 上傳方式

- **拖放上傳**: 支持拖放圖片到指定區域
- **點擊選擇**: 點擊上傳區域打開文件選擇器
- **貼上上傳**: 支持 Ctrl+V 貼上剪貼板圖片

#### 3.1.2 文件驗證

```javascript
支持格式: ['image/jpeg', 'image/png', 'image/gif', 'image/webp']
最大文件大小: 10MB
最小尺寸: 10x10 像素
最大尺寸: 4096x4096 像素
```

#### 3.1.3 上傳後處理

- 顯示圖片預覽
- 顯示原始尺寸信息
- 自動居中對齊

### 3.2 圖片調整控制

#### 3.2.1 縮放控制

```javascript
控制類型: 滑塊 (range slider)
範圍: 10% - 500%
預設值: 100%
步進值: 1%
即時預覽: true
顯示格式: "縮放: {value}%"
```

#### 3.2.2 輸出尺寸設定

```javascript
輸入方式:
  - 寬度輸入框 (number input)
  - 高度輸入框 (number input)
  - 預設尺寸快速選擇按鈕

預設尺寸選項:
  - Instagram Post: 1080x1080
  - Instagram Story: 1080x1920
  - Facebook Post: 1200x630
  - Twitter Post: 1200x675
  - LinkedIn Post: 1200x627
  - 自定義: 用戶輸入

驗證規則:
  - 最小值: 50px
  - 最大值: 4096px
  - 必須為正整數
```

#### 3.2.3 圖片位置

```javascript
預設位置: 居中;
未來擴展: 九宮格定位選擇器;
```

### 3.3 背景設定模組

#### 3.3.1 背景類型選擇

```javascript
類型選項:
  1. 純色 (solid)
  2. 線性漸層 (linear-gradient)
  3. 徑向漸層 (radial-gradient)
```

#### 3.3.2 純色背景

```javascript
控制元素:
  - 顏色選擇器 (color picker)
  - HEX 值輸入框
  - 預設顏色快速選擇

預設顏色:
  - 白色: #FFFFFF
  - 黑色: #000000
  - 灰色: #F0F0F0
  - 透明: transparent (導出為PNG)
```

#### 3.3.3 線性漸層背景

```javascript
控制元素:
  - 起始顏色選擇器
  - 結束顏色選擇器
  - 方向選擇器

方向選項:
  - 上到下 (0deg)
  - 左到右 (90deg)
  - 左上到右下 (45deg)
  - 右上到左下 (-45deg)
  - 自定義角度 (0-360deg)

中間色點 (可選):
  - 最多支持 5 個色點
  - 可調整位置 (0-100%)
```

#### 3.3.4 徑向漸層背景

```javascript
控制元素:
  - 中心顏色選擇器
  - 邊緣顏色選擇器
  - 漸層形狀 (circle/ellipse)
  - 中心點位置 (預設: center)
```

### 3.4 智能顏色推薦 (Nice to have)

#### 3.4.1 顏色提取

```javascript
使用 Color Thief 庫:
  - 提取主色調
  - 提取調色板 (5-10個顏色)
  - 計算互補色
  - 計算類似色
```

#### 3.4.2 推薦方案

```javascript
推薦類型:
  1. 主色調漸層: 主色 → 主色的暗色/亮色
  2. 互補色漸層: 主色 → 互補色
  3. 類似色漸層: 相近色系漸變
  4. 中性背景: 基於圖片亮度推薦灰階
```

### 3.5 預覽與導出

#### 3.5.1 實時預覽

```javascript
預覽區域:
  - 響應式縮放顯示
  - 顯示實際尺寸信息
  - 網格背景顯示透明度

更新觸發:
  - 任何參數改變立即更新
  - 使用 requestAnimationFrame 優化性能
```

#### 3.5.2 導出功能

```javascript
導出格式:
  - PNG (支持透明度)
  - JPEG (可選擇質量 0.7-1.0)
  - WEBP (如瀏覽器支持)

導出選項:
  - 文件名自定義
  - 質量選擇 (JPEG/WEBP)
  - 下載按鈕
```

## 4. 用戶界面設計

### 4.1 頁面佈局

```
┌─────────────────────────────────────┐
│          Header (標題區)              │
├─────────────────────────────────────┤
│                                     │
│  ┌──────────┐    ┌──────────────┐  │
│  │          │    │              │  │
│  │  Upload  │    │   Preview    │  │
│  │   Area   │    │    Area      │  │
│  │          │    │              │  │
│  └──────────┘    └──────────────┘  │
│                                     │
├─────────────────────────────────────┤
│         Control Panel               │
│  ┌─────────────────────────────┐   │
│  │ • 縮放控制                   │   │
│  │ • 尺寸設定                   │   │
│  │ • 背景設定                   │   │
│  │ • 智能推薦                   │   │
│  └─────────────────────────────┘   │
├─────────────────────────────────────┤
│      Export Controls (導出區)        │
└─────────────────────────────────────┘
```

### 4.2 響應式設計

```javascript
斷點設計:
  - 桌面: >= 1024px (並排佈局)
  - 平板: 768px - 1023px (堆疊佈局)
  - 手機: < 768px (單欄佈局)
```

### 4.3 UIKit 組件使用

```javascript
必用組件:
  - uk-card: 各功能區塊容器
  - uk-button: 所有按鈕
  - uk-form-*: 表單控件
  - uk-range: 滑塊控件
  - uk-tab: 背景類型切換
  - uk-grid: 網格佈局
  - uk-modal: 錯誤提示/幫助說明
  - uk-notification: 操作反饋
  - uk-upload: 上傳區域
  - uk-spinner: 處理中指示器
```

## 5. 核心實現邏輯

### 5.1 Canvas 繪製流程

```javascript
繪製步驟:
  1. 創建 canvas 元素，設定目標尺寸
  2. 獲取 2D context
  3. 繪製背景 (純色/漸層)
  4. 計算圖片縮放後的尺寸
  5. 計算圖片居中位置
  6. 使用 drawImage 繪製圖片
  7. 導出 canvas 內容
```

### 5.2 性能優化

```javascript
優化策略:
  - 使用 Web Worker 處理大圖 (可選)
  - 預覽使用較低解析度
  - 防抖動 (debounce) 處理滑塊事件
  - 圖片預載入和緩存
  - 使用 requestAnimationFrame
```

### 5.3 錯誤處理

```javascript
錯誤類型:
  - 文件格式不支持
  - 文件過大
  - 圖片載入失敗
  - Canvas 大小超限
  - 瀏覽器不支持

處理方式:
  - UIKit notification 顯示錯誤
  - 提供解決建議
  - 保持應用穩定不崩潰
```

## 6. 文件結構

```
project/
├── index.html          # 主頁面
├── css/
│   └── style.css      # 自定義樣式
├── js/
│   ├── app.js         # 主應用邏輯
│   ├── imageProcessor.js  # 圖片處理模組
│   ├── colorExtractor.js  # 顏色提取模組
│   └── utils.js       # 工具函數
└── assets/
    └── placeholder.svg # 佔位圖
```

## 7. 部署需求

- 靜態網站託管服務 (GitHub Pages, Netlify, Vercel)
- HTTPS 支持 (某些 API 需要)
- 無需後端服務器
- 無需數據庫

## 8. 未來擴展

- 批量處理多張圖片
- 保存/載入預設配置
- 更多背景效果 (圖案、紋理)
- 圖片濾鏡效果
- 社交媒體直接分享
- PWA 支持離線使用

---

這份規格文件提供了完整的實現指南，AI 可以根據這份文件逐步實現各個功能模組。建議實施順序：

1. 基礎 HTML 結構和 UIKit 整合
2. 圖片上傳和預覽
3. Canvas 繪製邏輯
4. 控制面板功能
5. 導出功能
6. 智能顏色推薦（可選）
